
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orbitmate API ëŒ€í™”í˜• ë¬¸ì„œ/í…ŒìŠ¤íŠ¸</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    /* api_docs.js ì „ìš© ìŠ¤íƒ€ì¼ (ê³µí†µ ìŠ¤íƒ€ì¼ì€ style.cssë¡œ ì´ë™) */
    body { background: #f8f9fa; color: #222; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .container { max-width: 900px; margin: 30px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 30px; }
    h1 { color: #007bff; text-align: center; }
    .api-list { margin: 30px 0; }
    .api-item { border-bottom: 1px solid #eee; padding: 18px 0; }
    .api-item:last-child { border-bottom: none; }
    .api-title { font-size: 1.1em; font-weight: bold; color: #007bff; }
    .api-method { font-weight: bold; margin-right: 8px; }
    .api-path { font-family: monospace; }
    .api-desc { margin: 8px 0 12px 0; color: #444; }
    .api-test { background: #f8f9fa; border: 1px solid #ddd; border-radius: 6px; padding: 14px; margin-top: 10px; }
    .api-test label { font-weight: bold; display: block; margin-bottom: 4px; }
    .api-test input, .api-test textarea { width: 100%; margin-bottom: 8px; padding: 7px; border-radius: 4px; border: 1px solid #ccc; font-size: 1em; }
    .api-test button { background: #007bff; color: #fff; border: none; border-radius: 4px; padding: 7px 18px; font-size: 1em; cursor: pointer; }
    .api-test button:disabled { background: #aaa; }
    .api-test .result { background: #e9ecef; border: 1px solid #dee2e6; border-radius: 4px; padding: 10px; margin-top: 8px; font-size: 0.97em; white-space: pre-wrap; word-break: break-all; }
    .api-test .result.error { color: #c00; background: #fff0f0; border-color: #f5c2c7; }
    .token-box { margin-bottom: 18px; }
    .token-box input { width: 80%; display: inline-block; }
    .token-box button { margin-left: 8px; }
    .footer { text-align: center; color: #888; margin-top: 40px; }
    .api-desc-note { color: #888; font-size: 0.97em; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Orbitmate API ëŒ€í™”í˜• ë¬¸ì„œ/í…ŒìŠ¤íŠ¸</h1>
    <div class="token-box" style="opacity:0.5;pointer-events:none;background:linear-gradient(90deg,#e3eafc 0%,#f8f9fa 100%);border:1.5px dashed #b6c6e3;box-shadow:0 2px 8px rgba(0,123,255,0.04);padding:18px 16px 12px 16px; border-radius:8px; margin-bottom:28px;">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px;">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" style="vertical-align:middle;"><circle cx="12" cy="12" r="10" fill="#e3eafc"/><path d="M8.5 12.5l2.5 2.5 4.5-4.5" stroke="#007bff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <label style="font-weight:bold;font-size:1.08em;color:#007bff;letter-spacing:0.5px;">JWT í† í° (í…ŒìŠ¤íŠ¸ìš©, í˜„ì¬ ë¹„í™œì„±í™”)</label>
      </div>
      <input type="text" id="jwt-token" placeholder="(ë¹„í™œì„±í™”)" style="background:#f4f7fb;color:#888;">
      <button disabled style="background:#b6c6e3;color:#fff;">ì €ì¥</button>
      <button disabled style="background:#e3eafc;color:#888;">ì§€ìš°ê¸°</button>
      <div class="api-desc-note" style="margin-top:4px;">ë¡œê·¸ì¸/íšŒì›ê°€ì… í›„ í† í°ì„ ë³µì‚¬í•´ ë¶™ì—¬ë„£ìœ¼ë©´ ì¸ì¦ API í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>(ìµœì†Œì‚¬í–¥ ì œí’ˆì—ì„œ ë¹„í™œì„±í™”ë¨)</div>
    </div>
    <div class="api-list" id="api-list"></div>
    <div class="footer">Â© 2025 Orbitmate - AI ì±„íŒ… ì„œë¹„ìŠ¤</div>
  </div>
  <script>
  const apis = [
    {
      method: 'GET',
      path: '/api/health',
      title: 'ì„œë²„ ìƒíƒœ í™•ì¸',
      desc: 'ì„œë²„ì˜ í˜„ì¬ ìƒíƒœì™€ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.',
      params: [],
      exampleReq: '',
      exampleRes: `{
"status": "ok",
"timestamp": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
    },
    /* 2. ì‚¬ìš©ì ê´€ë¦¬ */
    {
      method: 'POST',
      path: '/api/users/register',
      title: 'íšŒì›ê°€ì…',
      desc: 'ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.<br><span class="api-desc-note">usernameì— "APItest", emailì— "API@example.com", passwordì— "password123"ì„ ì…ë ¥í•˜ë©´ <b>user_id</b>ëŠ” í•­ìƒ "API_TEST_USER_ID"ë¡œ ê³ ì •ë©ë‹ˆë‹¤.</span>',
      params: [
        { name: 'username', type: 'text', label: 'ì‚¬ìš©ìëª…', required: true },
        { name: 'email', type: 'email', label: 'ì´ë©”ì¼', required: true },
        { name: 'password', type: 'password', label: 'ë¹„ë°€ë²ˆí˜¸', required: true }
      ],
      exampleReq: `{
"username": "APItest",
"email": "API@example.com",
"password": "password123"
}`,
      exampleRes: `{
"user_id": "API_TEST_USER_ID",
"username": "APItest",
"email": "API@example.com",
"created_at": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
    },
    {
      method: 'POST',
      path: '/api/users/login',
      title: 'ë¡œê·¸ì¸',
      desc: 'ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.<br><span class="api-desc-note">emailì— "API@example.com", passwordì— "password123"ì„ ì…ë ¥í•˜ë©´ user_idëŠ” í•­ìƒ "API_TEST_USER_ID"ë¡œ ê³ ì •ë©ë‹ˆë‹¤.</span>',
      params: [
        { name: 'email', type: 'email', label: 'ì´ë©”ì¼', required: true },
        { name: 'password', type: 'password', label: 'ë¹„ë°€ë²ˆí˜¸', required: true }
      ],
      exampleReq:  `{
"email": "API@example.com",
"password": "password123"
}`,
      exampleRes:  `{
"user_id": "API_TEST_USER_ID",
"username": "APItest",
"email": "API@example.com",
"logged_in_at": "YYYY-MM-DDTHH:mm:ss.sssZ",
"token": "ëœë¤í•œ ë¬¸ìì—´"
}`
    },
    {
      method: 'GET',
      path: '/api/users/:user_id/settings',
      title: 'ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ ì„¤ì •ì„ ì¡°íšŒí•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì˜ ì„¤ì •ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  `{
"user_id": "API_TEST_USER_ID",
"theme": "light",
"language": "ko",
"font_size": 14,
"notifications_enabled": true,
"ai_model_preference": null
}`
    },
    {
      method: 'PUT',
      path: '/api/users/:user_id/settings',
      title: 'ì‚¬ìš©ì ì„¤ì • ìˆ˜ì •',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ ì„¤ì •ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì˜ ì„¤ì •ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true },
        { name: 'theme', type: 'text', label: 'í…Œë§ˆ', required: false },
        { name: 'notifications_enabled', type: 'checkbox', label: 'ì•Œë¦¼ ì‚¬ìš©', required: false }
      ],
      exampleReq:  `{
"theme": "light",
"notifications_enabled": false
}`,
      exampleRes:  `{
"user_id": "API_TEST_USER_ID",
"theme": "light",
"language": "ko",
"font_size": 14,
"notifications_enabled": false,
"ai_model_preference": null
}`
    },
    {
      method: 'POST',
      path: '/api/users/:user_id/profile/image',
      title: 'í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì˜ í”„ë¡œí•„ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true },
        { name: 'profileImage', type: 'file', label: 'í”„ë¡œí•„ ì´ë¯¸ì§€', required: true }
      ],
      exampleReq: '(multipart/form-data)',
      exampleRes: `{
"message": "í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.",
"user_id": "API_TEST_USER_ID",
"profile_image_path": "/uploads/API_TEST_USER_ID-YYYY-MM-DDTHH:mm:ss.sssZ-Orbitmate.png"
}`
    },
    {
      method: 'DELETE',
      path: '/api/users/:user_id',
      title: 'íšŒì› íƒˆí‡´',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ ê³„ì •ì„ ì‚­ì œí•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  `{
"message": "ì‚¬ìš©ì ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
"user_id": "API_TEST_USER_ID"
}`
    },
    {
      method: 'GET',
      path: '/api/users/:user_id/profile',
      title: 'í”„ë¡œí•„ ì¡°íšŒ',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì˜ í”„ë¡œí•„ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  `{
"user_id": "API_TEST_USER_ID",
"username": "APItest",
"email": "API@example.com",
"profile_image_url": "/uploads/profiles/API_TEST_USER_ID-profile.jpg",
"bio": "í…ŒìŠ¤íŠ¸ ê³„ì •ì…ë‹ˆë‹¤."
}`
    },
    {
      method: 'PUT',
      path: '/api/users/:user_id/profile',
      title: 'í”„ë¡œí•„ ìˆ˜ì •',
      desc: 'íŠ¹ì • ì‚¬ìš©ìì˜ í”„ë¡œí•„ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ì˜ í”„ë¡œí•„ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true, inPath: true },
        { name: 'username', type: 'text', label: 'ì‚¬ìš©ìëª…', required: false },
        { name: 'bio', type: 'text', label: 'ìê¸°ì†Œê°œ', required: false }
      ],
      exampleReq:  `{
"username": "APItest",
"bio": "í…ŒìŠ¤íŠ¸ ê³„ì •ì…ë‹ˆë‹¤."
}`,
      exampleRes:  `{
"user_id": "API_TEST_USER_ID",
"username": "APItest",
"email": "API@example.com",
"created_at": "YYYY-MM-DDTHH:mm:ss.sssZ",
"is_active": 1,
"profile_image_path": null,
"theme_preference": "light",
"bio": "í…ŒìŠ¤íŠ¸ ê³„ì •ì…ë‹ˆë‹¤.",
"badge": null,
"experience": 0,
"level": 1,
"updated_at": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
},
    /* 3. ì±„íŒ… ì„¸ì…˜ ê´€ë¦¬ */
    {
      method: 'POST',
      path: '/api/chat/sessions',
      title: 'ì±„íŒ… ì„¸ì…˜ ìƒì„±',
      desc: 'ìƒˆë¡œìš´ ì±„íŒ… ì„¸ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.<br><span class="api-desc-note">user_idì— "API_TEST_USER_ID"ë¥¼ ì…ë ¥í•˜ë©´ í…ŒìŠ¤íŠ¸ ê³„ì •ìœ¼ë¡œ ì„¸ì…˜ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>',
      params: [
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: true },
        { name: 'title', type: 'text', label: 'ì„¸ì…˜ ì œëª©', required: true },
        { name: 'category', type: 'text', label: 'ì¹´í…Œê³ ë¦¬', required: false }
      ],
      exampleReq:  `{
"user_id": "API_TEST_USER_ID",
"title": "í…ŒìŠ¤íŠ¸ ì„¸ì…˜",
"category": "ì¼ë°˜"
}`,
      exampleRes:  `{
"session_id": "API_TEST_SESSION_ID",
"user_id": "API_TEST_USER_ID",
"title": "í…ŒìŠ¤íŠ¸ ì„¸ì…˜",
"category": "ì¼ë°˜",
"created_at": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
    },
    {
      method: 'PUT',
      path: '/api/chat/sessions/:session_id',
      title: 'ì±„íŒ… ì„¸ì…˜ ì •ë³´ ìˆ˜ì •',
      desc: 'íŠ¹ì • ì±„íŒ… ì„¸ì…˜ì˜ ì •ë³´ë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤.',
      params: [
        { name: 'session_id', type: 'text', label: 'ì„¸ì…˜ ID', required: true, inPath: true },
        { name: 'title', type: 'text', label: 'ì„¸ì…˜ ì œëª©', required: false },
        { name: 'category', type: 'text', label: 'ì¹´í…Œê³ ë¦¬', required: false },
        { name: 'is_archived', type: 'checkbox', label: 'ë³´ê´€ ì—¬ë¶€', required: false }
      ],
      exampleReq:  ` {
"title": "ìˆ˜ì •ëœ ì„¸ì…˜ ì œëª©",
"category": "ì¤‘ìš”",
"is_archived": true
}`,
      exampleRes:  `{
"session_id": "API_TEST_SESSION_ID",
"title": "ìˆ˜ì •ëœ ì„¸ì…˜ ì œëª©",
"category": "ì¤‘ìš”",
"is_archived": true,
"updated_at": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
    },
    {
      method: 'DELETE',
      path: '/api/chat/sessions/:session_id',
      title: 'ì±„íŒ… ì„¸ì…˜ ì‚­ì œ',
      desc: 'íŠ¹ì • ì±„íŒ… ì„¸ì…˜ì„ ì‚­ì œí•©ë‹ˆë‹¤. ìš”ì²­ ë³¸ë¬¸ì— user_idë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.',
      params: [
        { name: 'session_id', type: 'text', label: 'ì„¸ì…˜ ID', required: true, inPath: true },
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID (ìš”ì²­ ë³¸ë¬¸)', required: true, inBody: true, default: 'API_TEST_USER_ID' }
      ],
      exampleReq:  `{
"user_id": "API_TEST_USER_ID"
}`,
      exampleRes:  ` {
"message": "ì±„íŒ… ì„¸ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}`
    },
    {
      method: 'GET',
      path: '/api/chat/sessions/:session_id/messages',
      title: 'ì„¸ì…˜ ë©”ì‹œì§€ ëª©ë¡ ì¡°íšŒ',
      desc: 'íŠ¹ì • ì±„íŒ… ì„¸ì…˜ì˜ ëª¨ë“  ë©”ì‹œì§€ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.',
      params: [
        { name: 'session_id', type: 'text', label: 'ì„¸ì…˜ ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  ` [{ "message_id": "ë©”ì‹œì§€ ID", "message_content": "ë‚´ìš©", ... }]`
    },
    /* 4. ì±„íŒ… ë©”ì‹œì§€ ê´€ë¦¬ */
    {
      method: 'POST',
      path: '/api/chat/sessions/:session_id/messages',
      title: 'ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡',
      desc: 'íŠ¹ì • ì±„íŒ… ì„¸ì…˜ì— ìƒˆ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê³  AIì˜ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤.',
      params: [
        { name: 'session_id', type: 'text', label: 'ì„¸ì…˜ ID', required: true, inPath: true, default: 'API_TEST_SESSION_ID' }, // ì¶”ê°€ëœ ì„¸ì…˜ ID íŒŒë¼ë¯¸í„°
        { name: 'message', type: 'text', label: 'ë©”ì‹œì§€', required: true },
        { name: 'system_prompt', type: 'text', label: 'ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸', required: false },
        { name: 'special_mode_type', type: 'text', label: 'íŠ¹ìˆ˜ ëª¨ë“œ', required: false }
      ],
      exampleReq:  `{
"message": "ì•ˆë…•! ì˜¤ëŠ˜ ë‚ ì”¨ ì–´ë•Œ?",
"system_prompt": "(ì„ íƒ) AI í–‰ë™ ì§€ì‹œ",
"special_mode_type": "(ì„ íƒ) stream/canvas ë“±)"
}`,
      exampleRes:  `{
"user_message_id": "API_TEST_USER_MESSAGE_ID",
"ai_message_id": "API_TEST_AI_MESSAGE_ID",
"message": "ì•ˆë…•í•˜ì„¸ìš”! ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?",
"created_at": "YYYY-MM-DDTHH:mm:ss.sssZ"
}`
    },
    {
      method: 'PUT',
      path: '/api/chat/messages/:message_id',
      title: 'ë©”ì‹œì§€ ìˆ˜ì •',
      desc: 'íŠ¹ì • ë©”ì‹œì§€ì˜ ë‚´ìš©ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.',
      params: [
        { name: 'message_id', type: 'text', label: 'ë©”ì‹œì§€ ID', required: true, inPath: true },
        { name: 'content', type: 'text', label: 'ìˆ˜ì •í•  ë‚´ìš©', required: true }
      ],
      exampleReq:  `{
"content": "ìˆ˜ì •ëœ ë©”ì‹œì§€ ë‚´ìš©ì…ë‹ˆë‹¤."
}`,
      exampleRes:  `{
"message": "ë©”ì‹œì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
"updatedMessage": { ... }
}`
    },
    {
      method: 'DELETE',
      path: '/api/chat/messages/:message_id',
      title: 'ë©”ì‹œì§€ ì‚­ì œ',
      desc: 'íŠ¹ì • ë©”ì‹œì§€ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.',
      params: [
        { name: 'message_id', type: 'text', label: 'ë©”ì‹œì§€ ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  ` {
"message": "ë©”ì‹œì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
}`
    },
    {
      method: 'POST',
      path: '/api/chat/messages/:message_id/reaction',
      title: 'ë©”ì‹œì§€ ë¦¬ì•¡ì…˜ ì¶”ê°€',
      desc: 'íŠ¹ì • ë©”ì‹œì§€ì— ë¦¬ì•¡ì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.',
      params: [
        { name: 'message_id', type: 'text', label: 'ë©”ì‹œì§€ ID', required: true, inPath: true },
        { name: 'reaction', type: 'text', label: 'ë¦¬ì•¡ì…˜', required: true }
      ],
      exampleReq:  ` {
"reaction": "ğŸ‘"
}`,
      exampleRes:  ` {
"message": "ë¦¬ì•¡ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€/ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.",
"reaction": "ğŸ‘"
}`
    },
    {
      method: 'DELETE',
      path: '/api/chat/messages/:message_id/reaction',
      title: 'ë©”ì‹œì§€ ë¦¬ì•¡ì…˜ ì œê±°',
      desc: 'íŠ¹ì • ë©”ì‹œì§€ì˜ ë¦¬ì•¡ì…˜ì„ ì œê±°í•©ë‹ˆë‹¤.',
      params: [
        { name: 'message_id', type: 'text', label: 'ë©”ì‹œì§€ ID', required: true, inPath: true }
      ],
      exampleReq: '',
      exampleRes:  ` {
"message": "ë¦¬ì•¡ì…˜ì´ ì„±ê³µì ìœ¼ë¡œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤."
}`
    },
    /* 5. íŒŒì¼ ì—…ë¡œë“œ */
    {
      method: 'POST',
      path: '/api/chat/sessions/:session_id/files',
      title: 'íŒŒì¼ ì—…ë¡œë“œ (ì±„íŒ…)',
      desc: 'íŠ¹ì • ì±„íŒ… ì„¸ì…˜ì— íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³ , í•´ë‹¹ íŒŒì¼ ì •ë³´ë¥¼ ë©”ì‹œì§€ë¡œ ì €ì¥í•©ë‹ˆë‹¤.',
      params: [
        { name: 'session_id', type: 'text', label: 'ì„¸ì…˜ ID', required: true, inPath: true },
        { name: 'file', type: 'file', label: 'ì—…ë¡œë“œ íŒŒì¼', required: true },
        { name: 'user_id', type: 'text', label: 'ì‚¬ìš©ì ID', required: false }
      ],
      exampleReq: '(multipart/form-data)',
      exampleRes:  ` {
"message": "íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.",
"fileMessage": { ... }
}`
    }
  ];

  const apiList = document.getElementById('api-list');
  apis.forEach((api, idx) => {
    const div = document.createElement('div');
    div.className = 'api-item';
    const defaultValues = {
      'username': 'APItest',
      'email': 'API@example.com',
      'password': 'password123',
      'user_id': 'API_TEST_USER_ID',
      // 'user_id': 'API_TEST_USER_ID', // ì¤‘ë³µëœ í‚¤, í•˜ë‚˜ëŠ” ì œê±°í•˜ê±°ë‚˜ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ì™€ ê°™ì´ session_idë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
      'session_id': 'API_TEST_SESSION_ID', 
      'message_id': 'API_TEST_USER_MESSAGE_ID',
    };
    div.innerHTML = [
      '<div class="api-title"><span class="api-method">' + api.method + '</span> <span class="api-path">' + api.path + '</span> - ' + api.title + '</div>',
      '<div class="api-desc">' + api.desc + '</div>',
      '<details><summary>ìš”ì²­/ì‘ë‹µ ì˜ˆì‹œ ë³´ê¸°</summary>' +
        '<div><b>ìš”ì²­ ì˜ˆì‹œ:</b><pre>' + (api.exampleReq || '-') + '</pre></div>' +
        '<div><b>ì‘ë‹µ ì˜ˆì‹œ:</b><pre>' + (api.exampleRes || '-') + '</pre></div>' +
      '</details>',
      '<form class="api-test" onsubmit="return false;" id="form-' + idx + '">',
        api.params.filter(function(p){return p.inPath;}).map(function(p) {
          const def = defaultValues[p.name] ? ' value="' + defaultValues[p.name] + '"' : '';
          return '<label>' + p.label + (p.required ? ' *' : '') + '</label>' +
            '<input type="text" name="' + p.name + '"' + (p.required ? ' required' : '') + def + ' placeholder="(URL ê²½ë¡œì— ì‚¬ìš©)">';
        }).join(''),
        ((api.method === 'POST' || api.method === 'PUT') && api.params.filter(function(p){return !p.inPath && p.type!=='file';}).length > 0
          ? '<label>ìš”ì²­ JSON</label><textarea name="jsonBody" rows="5">' + (api.exampleReq && api.exampleReq !== '' ? api.exampleReq : '{}') + '</textarea>'
          : ''),
        api.params.filter(function(p){return p.type==='file';}).map(function(p) {
          return '<label>' + p.label + (p.required ? ' *' : '') + '</label>' +
            '<input type="file" name="' + p.name + '"' + (p.required ? ' required' : '') + '>';
        }).join(''),
        '<button type="submit">API í˜¸ì¶œ</button>',
        '<div class="result" style="display:none;"></div>',
      '</form>'
    ].join('');
    apiList.appendChild(div);
    setTimeout(function() { 
      var form = document.getElementById('form-' + idx);
      if (!form) return;
      form.onsubmit = async function(event) {
        event.preventDefault();
        const resultDiv = form.querySelector('.result');
        resultDiv.style.display = 'block';
        resultDiv.textContent = 'ìš”ì²­ ì¤‘...';
        let url = api.path;
        let hasBody = api.method === 'POST' || api.method === 'PUT';
        api.params.filter(p => p.inPath).forEach(p => {
          const v = form.elements[p.name].value;
          url = url.replace(':' + p.name, encodeURIComponent(v));
        });
        let fetchOpts = { method: api.method, headers: {} };
        const hasFile = api.params.some(p => p.type === 'file');
        if (hasFile) {
          const formData = new FormData();
          api.params.filter(p => p.type === 'file').forEach(p => {
            const fileInput = form.elements[p.name];
            if (fileInput && fileInput.files.length > 0) {
              formData.append(p.name, fileInput.files[0]);
            }
          });
          if (hasBody && form.elements['jsonBody']) {
            try {
              const json = JSON.parse(form.elements['jsonBody'].value);
              Object.keys(json).forEach(k => formData.append(k, json[k]));
            } catch {
              resultDiv.className = 'result error';
              resultDiv.textContent = 'JSON í˜•ì‹ ì˜¤ë¥˜';
              return;
            }
          }
          fetchOpts.body = formData;
        } else if (hasBody && form.elements['jsonBody']) {
          try {
            fetchOpts.headers['Content-Type'] = 'application/json';
            fetchOpts.body = form.elements['jsonBody'].value;
            JSON.parse(fetchOpts.body);
          } catch {
            resultDiv.className = 'result error';
            resultDiv.textContent = 'JSON í˜•ì‹ ì˜¤ë¥˜';
            return;
          }
        }
        const token = localStorage.getItem('token');
        if (token) fetchOpts.headers['Authorization'] = 'Bearer ' + token;
        try {
          const resp = await fetch(url, fetchOpts);
          const text = await resp.text();
          let display = '';
          try { display = JSON.stringify(JSON.parse(text), null, 2); } catch { display = text; }
          resultDiv.className = 'result' + (resp.ok ? '' : ' error');
          resultDiv.textContent = 'Status: ' + resp.status + ' ' + resp.statusText + '\n' + display;
        } catch (e) {
          resultDiv.className = 'result error';
          resultDiv.textContent = 'API í˜¸ì¶œ ì˜¤ë¥˜: ' + e.message;
        }
      };
    }, 0);
  });
</script>
</body>
</html>
